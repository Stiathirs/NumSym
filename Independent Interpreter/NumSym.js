var code="",input="";process.argv.length<3&&(console.log("Usage: node "+process.argv[1]+" NUMSYMFILE [INPUTSTRING]"),process.exit(1));var fs=require("fs"),filename=process.argv[2];fs.readFile(filename,"utf8",function(err,data){if(err)throw err;code=data,input=3<process.argv.length?process.argv[3]:"";var i=0,ignoreEndCmd=!1,inputi=0,stack=[],balance=0;for(code=code.replace(/[^0-9\+\-\*\/%^!@;#$<=>\[\]]/g,"");i<code.length;){var currentChar=code.charAt(i);if(/[0-9]/.test(currentChar)&&stack.push(Number(currentChar)),/\^/g.test(currentChar)&&(inputi<input.length?(stack.push(input.charAt(inputi).charCodeAt(0)),inputi++):stack.push(0)),/!/.test(currentChar)){if(!(0<stack.length))throw{name:"StackUnderflowError",message:"Stack is empty"};var temp=stack.pop();stack.push(temp,temp)}if(/@/.test(currentChar)&&(stack=stack.reverse()),/[\+\*\-\/\%]/.test(currentChar)){if(!(1<stack.length))throw{name:"StackUnderflowError",message:"Stack contains less than two values"};var right=stack.pop(),left=stack.pop(),str=left.toString()+currentChar+right.toString();stack.push(eval(str))}if(/\#/.test(currentChar)){if(!(0<stack.length))throw{name:"StackUnderflowError",message:"Stack is empty"};process.stdout.write(stack.pop().toString())}if(/\$/.test(currentChar)){if(!(0<stack.length))throw{name:"StackUnderflowError",message:"Stack is empty"};process.stdout.write(String.fromCharCode(stack.pop()))}if(/;/.test(currentChar)){if(!(0<stack.length))throw{name:"StackUnderflowError",message:"Stack is empty"};stack.pop()}if(/[=<>]/.test(currentChar)){if(!(1<stack.length))throw{name:"StackUnderflowError",message:"Stack contains less than two values"};var right=stack.pop(),left=stack.pop(),str;"="==currentChar?right==left?stack.push(1):stack.push(0):(str=left.toString()+currentChar+right.toString(),eval(str)?stack.push(1):stack.push(0))}if(/\[/g.test(currentChar)){if(!(0<stack.length))throw{name:"StackUnderflowError",message:"Stack is empty"};var temp=stack.pop();if(stack.push(temp,temp),0!=stack.pop())balance++;else{var origBal=balance;for(balance++;balance!=origBal&&i<code.length;)i++,currentChar=code.charAt(i),"["==currentChar?balance++:"]"==currentChar&&balance--;ignoreEndCmd=!0}}if(!ignoreEndCmd&&/\]/g.test(currentChar)&&0<balance){var origBal=balance;for(balance--;balance!=origBal&&i<code.length;)i--,currentChar=code.charAt(i),"["==currentChar?balance++:"]"==currentChar&&balance--;i--}ignoreEndCmd=!1,i++}});